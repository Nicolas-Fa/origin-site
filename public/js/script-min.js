import{fetchCharacterInfo}from"./token.js";import{CLIENT_ID,CLIENT_SECRET}from"./vars.js";function afficherFormulaireEdition(e,t){const c=document.querySelectorAll(".formulaire_edition"),a=document.getElementById(`editer_${t}_${e}`);a&&(a&&a.classList.contains("cache")?(c.forEach((e=>{e.classList.replace("actif","cache")})),a.classList.replace("cache","actif")):a.classList.replace("actif","cache"))}function afficherFormulaireCommentaire(e){const t=document.querySelectorAll(".formulaire_commentaire"),c=document.getElementById(`commenter_postulation_${e}`);c&&(c&&c.classList.contains("cache")?(t.forEach((e=>{e.classList.replace("actif","cache")})),c.classList.replace("cache","actif")):c.classList.replace("actif","cache"))}function modifierCommentaire(e){const t=document.querySelectorAll(".modifier_formulaire"),c=document.getElementById(`editer_commentaire_${e}`);c&&(c&&c.classList.contains("cache")?(t.forEach((e=>{e.classList.replace("actif","cache")})),c.classList.replace("cache","actif")):c.classList.replace("actif","cache"))}document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("burger"),t=document.querySelector(".nav_liste"),c=e?.querySelector("i");e&&t&&c&&e.addEventListener("click",(function(e){e.preventDefault(),t.classList.toggle("active"),c.classList.toggle("fa-bars"),c.classList.toggle("fa-xmark")}));if(document.getElementById("twitch-embed")){const e=document.querySelector("#activer_twitch");e.addEventListener("click",(()=>{e.classList.add("cache");const t=document.createElement("script");t.src="https://player.twitch.tv/js/embed/v1.js",t.onload=()=>{const e=new Twitch.Player("twitch-embed",{video:"2419639839",muted:!0});e.addEventListener(Twitch.Player.READY,(()=>{e.pause()}))},document.head.appendChild(t)}))}if(document.querySelectorAll(".editer").forEach((e=>{e.addEventListener("click",(function(){afficherFormulaireEdition(e.getAttribute("data-id"),e.getAttribute("data-type"))}))})),window.location.search.includes("candidatures")){document.querySelectorAll(".commenter").forEach((e=>{e.addEventListener("click",(function(){afficherFormulaireCommentaire(e.getAttribute("data-id"))}))}))}if(window.location.search.includes("candidatures")){document.querySelectorAll(".editer").forEach((e=>{e.addEventListener("click",(function(){modifierCommentaire(e.getAttribute("data-id"))}))}))}if(window.location.search.includes("profil")||window.location.search.includes("connexion")){const e=document.querySelectorAll(".visualiser_personnage"),t=document.querySelector("#visualisation_personnage"),c=t.querySelector(".nom_personnage"),a=t.querySelector(".race_personnage"),n=t.querySelector(".classe_personnage"),r=t.querySelector(".image_personnage"),o=t.querySelector(".erreur_personnage");e.forEach((e=>{e.addEventListener("click",(async()=>{const t=e.getAttribute("data-pseudo"),i=e.getAttribute("data-royaume");c.textContent="",a.textContent="",n.textContent="",o.textContent="",r.src="",r.style.display="none";try{const{character:e,media:o}=await fetchCharacterInfo(i,t);c.textContent=`${t.charAt(0).toUpperCase()+t.slice(1)} - ${i.charAt(0).toUpperCase()+i.slice(1)}`,a.textContent=`Race : ${e.playable_race?.name??"Inconnue"}`,n.textContent=`Classe : ${e.playable_class?.name??"Inconnue"}`;const s=o.assets?.find((e=>"main-raw"===e.key)).value;document.querySelector(".image_personnage").src=s,r.style.display="block",r.alt=c.textContent,s&&(r.src=s)}catch(e){o.textContent=`Erreur : ${e.message}`}}))}))}if(window.location.search.includes("postuler")){const e=document.getElementById("postulation"),t=document.getElementById("compteur"),c=()=>{const c=e.value.replace(/\s/g,"");t.textContent=`${c.length} / 750`};e.addEventListener("input",c),c(),e.addEventListener("input",c),c()}}));